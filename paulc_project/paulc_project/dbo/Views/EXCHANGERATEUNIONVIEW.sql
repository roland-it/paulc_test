CREATE VIEW [dbo].[EXCHANGERATEUNIONVIEW] AS SELECT T1.EXCHANGERATETYPE AS EXCHANGERATETYPE,T1.VALIDFROM AS VALIDFROM,T1.VALIDTO AS VALIDTO,T1.PARTITION AS PARTITION,1010 AS RECID,(CAST ((T1.FROMCURRENCYCODE) AS NVARCHAR(3))) AS FROMCURRENCYCODE,(CAST ((T1.TOCURRENCYCODE) AS NVARCHAR(3))) AS TOCURRENCYCODE,(CAST ((T1.EXCHANGERATE) AS NUMERIC(32,16))) AS EXCHANGERATE FROM EXCHANGERATEVIEW T1 UNION SELECT T1.EXCHANGERATETYPE,T1.VALIDFROM,T1.VALIDTO,T1.PARTITION,1010,(CAST ((T1.TOCURRENCYCODE) AS NVARCHAR(3))) AS FROMCURRENCYCODE,(CAST ((T1.FROMCURRENCYCODE) AS NVARCHAR(3))) AS TOCURRENCYCODE,(CAST ((CASE T1.EXCHANGERATE when 0.0 then 0.0 else 100.0 * (1.0 / (T1.EXCHANGERATE / 100.0)) end) AS NUMERIC(32,16))) AS EXCHANGERATE FROM EXCHANGERATEVIEW T1 WHERE NOT (EXISTS (SELECT 'x' FROM EXCHANGERATECURRENCYPAIR T2 WHERE (((T1.TOCURRENCYCODE=T2.FROMCURRENCYCODE AND (T1.PARTITION = T2.PARTITION)) AND (T1.FROMCURRENCYCODE=T2.TOCURRENCYCODE AND (T1.PARTITION = T2.PARTITION))) AND (T1.EXCHANGERATETYPE=T2.EXCHANGERATETYPE AND (T1.PARTITION = T2.PARTITION)))))
