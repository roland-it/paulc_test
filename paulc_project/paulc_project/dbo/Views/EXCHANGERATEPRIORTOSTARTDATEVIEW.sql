CREATE VIEW [dbo].[EXCHANGERATEPRIORTOSTARTDATEVIEW] AS SELECT T1.FROMCURRENCYCODE AS FROMCURRENCYCODE,T1.TOCURRENCYCODE AS TOCURRENCYCODE,T1.VALIDFROM AS VALIDFROM,T1.VALIDTO AS VALIDTO,T1.EXCHANGERATE AS EXCHANGERATE,T1.EXCHANGERATETYPE AS EXCHANGERATETYPE,T1.PARTITION AS PARTITION,T1.RECID AS RECID,T2.PARTITION AS PARTITION#2,T3.PARTITION AS PARTITION#3,(CAST ((CASE when T2.CURRENCYCODE is not Null then T2.CURRENCYCODE when T3.CURRENCYCODE is not Null then T3.CURRENCYCODE else '' end) AS NVARCHAR(3))) AS FIXEDCURRENCY1,(CAST ((CASE when T2.CURRENCYCODE is not Null and T3.CURRENCYCODE is not Null then T3.CURRENCYCODE else '' end) AS NVARCHAR(3))) AS FIXEDCURRENCY2,(CAST ((CASE when T2.CURRENCYCODE is not Null then T2.STARTDATE when T3.CURRENCYCODE is not Null then T3.STARTDATE else '' end) AS DATETIME)) AS FIXEDSTARTDATE1,(CAST ((CASE when T2.CURRENCYCODE is not Null and T3.CURRENCYCODE is not Null then T3.STARTDATE else '' end) AS DATETIME)) AS FIXEDSTARTDATE2,(CAST ((CASE when T2.CURRENCYCODE is not Null then T2.EUROCURRENCYCODE when T3.CURRENCYCODE is not Null then T3.EUROCURRENCYCODE else '' end) AS NVARCHAR(3))) AS EUROCURRENCYCODE FROM  EXCHANGERATEUNIONVIEW T1 LEFT OUTER JOIN EXCHANGERATEEURODENOMINATIONVIEW T2 ON (T1.FROMCURRENCYCODE=T2.CURRENCYCODE AND (T1.PARTITION = T2.PARTITION)) LEFT OUTER JOIN EXCHANGERATEEURODENOMINATIONVIEW T3 ON (T1.TOCURRENCYCODE=T3.CURRENCYCODE AND (T1.PARTITION = T3.PARTITION))
