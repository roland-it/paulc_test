CREATE VIEW [dbo].[EXCHANGERATEDENTOVARAFTERSTARTVIEW] AS SELECT T1.EXCHANGERATETYPE AS EXCHANGERATETYPE,T1.FROMCURRENCYCODE AS FROMCURRENCYCODE,T1.TOCURRENCYCODE AS TOCURRENCYCODE,T1.PARTITION AS PARTITION,T1.RECID AS RECID,T2.PARTITION AS PARTITION#2,T2.STARTDATE AS STARTDATE,T2.CURRENCYCODE AS EURODENCURRENCYCODE,T2.EXCHANGERATE AS EURODENEXCHANGERATE,T3.PARTITION AS PARTITION#3,T3.VALIDFROM AS VALIDFROM,T3.VALIDTO AS VALIDTO,T3.EXCHANGERATE AS EXCHANGERATE FROM EXCHANGERATECURRENCYPAIR T1 CROSS JOIN EXCHANGERATEEURODENOMINATIONVIEW T2 CROSS JOIN EXCHANGERATE T3 WHERE (T1.FROMCURRENCYCODE=T2.EUROCURRENCYCODE AND (T1.PARTITION = T2.PARTITION)) AND ((T3.VALIDTO>=T2.STARTDATE AND (T3.PARTITION = T2.PARTITION)) AND (T1.RECID=T3.EXCHANGERATECURRENCYPAIR AND (T1.PARTITION = T3.PARTITION))) AND NOT (EXISTS (SELECT 'x' FROM EXCHANGERATEEURODENOMINATIONVIEW T4 WHERE (T1.TOCURRENCYCODE=T4.CURRENCYCODE AND (T1.PARTITION = T4.PARTITION))))
